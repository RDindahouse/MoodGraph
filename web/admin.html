<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Admin – Mood</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/styles.css" />
</head>

<body class="admin-page">
  <div class="container">
    <!-- top bar with navigation and global theme toggle -->
    <div class="top-bar">
      <h1 data-i18n="adminPanelTitle">Admin Panel</h1>
      <div class="header-controls" style="gap:10px; margin-left:auto; align-items:center;">
        <button id="theme-toggle" class="theme-toggle" type="button">
          <img id="theme-icon" src="/icons/dark_theme.svg" width="20" height="20" />
        </button>

        <div class="language-selector">
          <select id="language-select" title="Language" autocomplete="off">
            <option value="en">English</option>
            <option value="ru">Русский</option>
          </select>
        </div>

        <div style="display:flex; align-items:center; gap:8px; margin-left:auto;">
          <a href="/" class="theme-toggle" data-i18n="adminHome">Home</a>
          <div class="auth-user" id="admin-auth-status"></div>
        </div>
      </div>
    </div>

    <div class="card mb-16">
      <div class="mt-8 small">
        <span data-i18n="currentAdminLabel">Current admin:</span>
        <span id="admin-username">Loading...</span><br />
        <span data-i18n="telegramStatusLabel">Telegram status:</span>
        <span id="admin-tg-status">Loading...</span>
      </div>
    </div>

    <div class="grid mt-16">
      <div class="card">
        <h2 data-i18n="botSiteSettings">Bot and Site Settings</h2>

        <div class="field">
          <label for="bot-token" data-i18n="botTokenLabel">Telegram Bot Token</label>
            <input id="bot-token" type="text" placeholder="123456:ABC-DEF..." autocomplete="off" />
        </div>

        <div class="field">
          <label for="site-base-url" data-i18n="siteAddressLabel">Site Address (for invites)</label>
            <input id="site-base-url" type="text" placeholder="https://example.com" autocomplete="off" />
          <div class="small" data-i18n="siteAddressHint">
            Used to form full invite link. If left empty, window.location.origin will be used.
          </div>
        </div>

        <button class="btn primary mb-16" id="btn-save-bot-token" data-i18n="saveSettings">
          Save Settings
        </button>

        <div class="status" id="status-bot" data-i18n="loading">Loading...</div>

        <div class="field mt-16">
          <h3 class="mb-12" data-i18n="botLanguageTitle">Bot Language (personal)</h3>
          <label for="admin-language" data-i18n="botLanguageLabel">Language for your bot messages:</label>
          <select id="admin-language"></select>
        </div>
        <button class="btn primary" id="btn-save-admin-language" data-i18n="saveLanguage">
          Save Language
        </button>
        <div class="status mt-8" id="status-admin-language"></div>
      </div>

      <div class="card">
        <h2 data-i18n="telegramLinking">Telegram Linking</h2>
        <button class="btn primary mt-8" id="btn-generate-link-token" data-i18n="generateLinkToken">
          Generate Link Token
        </button>
        <div class="status" id="status-link" data-i18n="linkStatusHint">
          Click button to get link token.
        </div>
      </div>
    </div>

    <div class="grid mt-16">
      <div class="card">
        <h2 data-i18n="changePasswordTitle">Change Admin Password</h2>

        <div class="field">
          <label for="pwd-old" data-i18n="currentPasswordLabel">Current Password</label>
            <input id="pwd-old" type="password" placeholder="Old password" autocomplete="new-password" />
        </div>

        <div class="field">
          <label for="pwd-new" data-i18n="newPasswordLabel">New Password</label>
            <input id="pwd-new" type="password" placeholder="New password" autocomplete="new-password" />
        </div>

        <div class="field">
          <label for="pwd-new2" data-i18n="repeatPasswordLabel">Repeat New Password</label>
            <input id="pwd-new2" type="password" placeholder="Repeat new" autocomplete="new-password" />
        </div>

        <button class="btn primary" id="btn-change-password" data-i18n="changePasswordBtn">
          Change Password
        </button>

        <div class="status mt-8" id="status-password" data-i18n="passwordStatusHint">
          Enter current and new password.
        </div>
      </div>
    </div>

    <div class="grid mt-16">
      <div class="card">
        <h2 data-i18n="myChartsTitle">My Charts</h2>

        <div class="field">
          <label for="board-title" data-i18n="newChartTitleLabel">New Chart Title</label>
            <input id="board-title" type="text" placeholder="E.g.: Daily mood" data-i18n="newChartTitlePlaceholder" autocomplete="off" />
        </div>

        <div class="field">
          <label>
            <input type="checkbox" id="board-public" />
            <span class="small" data-i18n="publicChartLabel">Public chart (visible to all on site)</span>
          </label>
        </div>

        <button class="btn primary" id="btn-create-board" data-i18n="createChartBtn">Create Chart</button>

        <div class="status mt-8" id="boards-status" data-i18n="loading">Loading...</div>
        <div class="mt-8" id="boards-list"></div>
      </div>

      <div class="card">
        <h2 data-i18n="invitesTitle">Invites</h2>

        <div class="field">
          <label for="invite-board" data-i18n="inviteBoardLabel">Chart to give access to</label>
          <select id="invite-board" autocomplete="off"></select>
        </div>

        <div class="field">
          <label for="invite-role" data-i18n="inviteRoleLabel">Who to invite</label>
          <select id="invite-role" autocomplete="off">
            <option value="user" data-i18n="inviteRoleUser">Regular user</option>
            <option value="admin" data-i18n="inviteRoleAdmin">Administrator</option>
          </select>
        </div>

        <button class="btn primary" id="btn-create-invite" data-i18n="createInviteBtn">Create Invite</button>

        <div class="status mt-8" id="invite-output" data-i18n="inviteStatusHint">
          Select chart and role first.
        </div>
        <div class="small mt-8" data-i18n="inviteOneTimeNote">
          Invite is one-time: after registration via token it becomes invalid.
        </div>
      </div>
    </div>

    <div class="card mt-16">
      <h2 data-i18n="usersAccessTitle">Users and Chart Access</h2>
      <div class="small" data-i18n="usersAccessHint">
        Here you can view which users have access to which charts, and enable/disable access.
      </div>
      <div class="mt-8" id="users-access-output" data-i18n="loading">Loading...</div>
    </div>
  </div>

  <!-- shared scripts -->
  <script src="/js/i18n.js"></script>
  <script src="/js/utils.js"></script>
  <script src="/js/api.js"></script>
  <script src="/js/admin.js"></script>
  <script src="/js/theme.js"></script>
